(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     52923,       1390]
NotebookOptionsPosition[     50976,       1320]
NotebookOutlinePosition[     51389,       1338]
CellTagsIndexPosition[     51346,       1335]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"baseline", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"0.202", " ", "--"}], " ", "radius", " ", "of", " ", "circle", 
     " ", "on", " ", "which", " ", "hydrophones", " ", "lie", 
     "\[IndentingNewLine]", "SoS"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"1550", " ", "--"}], " ", "speed", " ", "of", " ", "sound"}]}]}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.47317730184408*^9, 3.473177317371314*^9}, {
   3.473177784122135*^9, 3.47317786706072*^9}, 3.4731782672739697`*^9, {
   3.473178529698146*^9, 3.473178533993924*^9}, {3.473179432535522*^9, 
   3.473179441080729*^9}, {3.473179821843478*^9, 3.473179824817336*^9}, {
   3.473179872750113*^9, 3.473179876385648*^9}, {3.473180247892703*^9, 
   3.4731802549224577`*^9}, {3.473180865329249*^9, 3.473180865716063*^9}, {
   3.4731874716952887`*^9, 3.473187494661476*^9}, {3.47318752585781*^9, 
   3.473187583197546*^9}, {3.473187722149406*^9, 3.473187724129727*^9}, {
   3.4731877571793327`*^9, 3.473187758827065*^9}, {3.473187841697565*^9, 
   3.473187847415966*^9}, 3.473189141010854*^9, {3.4733430375778723`*^9, 
   3.473343039542091*^9}, {3.473352295552704*^9, 3.4733523348074923`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HydrophonePositions", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"baseline", ",", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"baseline", ",", "0"}], "}"}], ".", " ", 
      RowBox[{"RotationMatrix", "[", 
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"Pi", " ", "/", " ", "3"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"baseline", ",", "0"}], "}"}], " ", ".", 
      RowBox[{"RotationMatrix", "[", 
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        RowBox[{"Pi", " ", "/", " ", "3"}]}], "]"}]}]}], "}"}]}], ";", 
  RowBox[{"HydrophonePositions", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.47317730184408*^9, 3.473177317371314*^9}, {
   3.473177784122135*^9, 3.47317786706072*^9}, 3.4731782672739697`*^9, {
   3.473178529698146*^9, 3.473178533993924*^9}, {3.473179432535522*^9, 
   3.473179441080729*^9}, {3.473179821843478*^9, 3.473179824817336*^9}, {
   3.473179872750113*^9, 3.473179876385648*^9}, {3.473180247892703*^9, 
   3.4731802549224577`*^9}, {3.473180865329249*^9, 3.473180865716063*^9}, {
   3.4731874716952887`*^9, 3.473187494661476*^9}, {3.47318752585781*^9, 
   3.473187583197546*^9}, {3.473187722149406*^9, 3.473187724129727*^9}, {
   3.4731877571793327`*^9, 3.473187758827065*^9}, {3.473187841697565*^9, 
   3.473187847415966*^9}, 3.473189141010854*^9, {3.473237799840334*^9, 
   3.473237807743038*^9}, {3.4733303141805897`*^9, 3.473330316563283*^9}, {
   3.473346517304056*^9, 3.473346518948765*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"baseline", "0"},
     {
      RowBox[{"-", 
       FractionBox["baseline", "2"]}], 
      FractionBox[
       RowBox[{
        SqrtBox["3"], " ", "baseline"}], "2"]},
     {
      RowBox[{"-", 
       FractionBox["baseline", "2"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SqrtBox["3"], " ", "baseline"}], "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.473178267790554*^9, 3.473178347528624*^9, 3.473178535229328*^9, 
   3.473178592628694*^9, 3.4731789179700336`*^9, 3.4731789822300262`*^9, 
   3.473179205045829*^9, 3.473179441641329*^9, {3.47317982705199*^9, 
   3.473179843747102*^9}, 3.473179877631412*^9, 3.47318005982977*^9, 
   3.473180255815721*^9, 3.473180807089693*^9, 3.473182855517659*^9, 
   3.473185725727515*^9, 3.473186379934552*^9, {3.4731874783121853`*^9, 
   3.473187495032998*^9}, 3.473187586266803*^9, 3.47318772479318*^9, {
   3.473187759354261*^9, 3.473187789216617*^9}, 3.473187864880035*^9, 
   3.473188137988512*^9, 3.4731884856747026`*^9, 3.473189143416954*^9, 
   3.4731905611905107`*^9, 3.4732369122873*^9, 3.47323780824545*^9, 
   3.473327286553543*^9, 3.473329315935288*^9, 3.473330201684937*^9, 
   3.473330317179916*^9, 3.473342124320156*^9, 3.473352113145913*^9, 
   3.473359793697791*^9, 3.4734139717983637`*^9, 3.473416402496299*^9, 
   3.473421236680578*^9, 3.4734214250203323`*^9, 3.4734315103499537`*^9, 
   3.473596574017891*^9, 3.474174020601365*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RotatedPositions", ":=", 
   RowBox[{"HydrophonePositions", " ", ".", " ", 
    RowBox[{"RotationMatrix", "[", "\[Theta]", "]"}]}]}], ";", 
  RowBox[{"RotatedPositions", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.4731782802300997`*^9, 3.473178301793295*^9}, 
   3.473178489830471*^9, {3.473178539345007*^9, 3.473178545230981*^9}, 
   3.4731891332141867`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"baseline", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{"-", "baseline"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", "baseline", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox["3"], " ", "baseline", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox["3"], " ", "baseline", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "baseline", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", "baseline", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox["3"], " ", "baseline", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SqrtBox["3"], " ", "baseline", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "baseline", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOIeoUPX+x+8dGzMmX8XRIf+8H4PolccM/8GosOa3f6A
6GfLDqhMANKij0/ogGgr0cUeIPqQSm0aiO7lqpoBonnOB88F0WeO1m4G0QXb
Np4F0ZLFTwUmAmkn0U8Ck4C0VNCT8slAevqq+pMg2mjq3oQpQLrv9a1KEF24
U7YZRM+SclwKou8HbL8Aove97lOeCqS/HVW/AqJ7WtzL1gBpu+roZyC6p4gl
Zi2QLgpWnH4DSP/wnzvlJpCOWunLfAtIn791UxBEvzNZdvU+kC5dp7btCZA2
VrUoewGknwjPeMX08KWjz8dsKRYgzec3vYwNSP9ts+8D0YvEz1ZxA+lzix8I
xwDpuXOncJQ9eukIAFHUwAU=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EstimatedDelays", ":=", " ", 
   RowBox[{
    RowBox[{"RotatedPositions", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "*", " ", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", "/", " ", "SoS"}]}]}], ";", 
  RowBox[{
   RowBox[{"EstimatedDelays", "*", "SoS"}], "//", "MatrixForm", 
   " "}]}]], "Input",
 CellChangeTimes->{{3.4731783594629087`*^9, 3.473178449997561*^9}, {
   3.473178637301424*^9, 3.473178640773159*^9}, {3.473178712999515*^9, 
   3.473178750836823*^9}, {3.473178780857292*^9, 3.473178795450539*^9}, {
   3.473179461730154*^9, 3.473179490072801*^9}, {3.473179885643916*^9, 
   3.473179889592319*^9}, 3.473180038781842*^9, {3.473180216705145*^9, 
   3.473180224958396*^9}, {3.473180272299533*^9, 3.473180288856008*^9}, 
   3.473180337208146*^9, {3.473180535424012*^9, 3.473180537854917*^9}, 
   3.473184158674148*^9, {3.4731883352112303`*^9, 3.47318835991858*^9}, {
   3.4731884140377207`*^9, 3.473188439330694*^9}, 3.4731885050554657`*^9, {
   3.473188540232347*^9, 3.4731885982944202`*^9}, {3.4732369412183*^9, 
   3.4732369543933287`*^9}, {3.4733293224551277`*^9, 3.473329344362052*^9}, {
   3.473341594192836*^9, 3.4733416026036377`*^9}, {3.4733421129680557`*^9, 
   3.473342121748288*^9}, {3.473345226986616*^9, 3.473345230632208*^9}, {
   3.4733522743095207`*^9, 3.473352283849272*^9}, {3.4733557784864817`*^9, 
   3.473355783154533*^9}, 3.473355829601005*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", "baseline"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
      {
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           SqrtBox["3"], " ", "baseline", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", "baseline", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]},
      {
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], " ", 
           SqrtBox["3"], " ", "baseline", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", "baseline", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.473239013949181*^9, 3.4733272905658827`*^9, {3.473329318139503*^9, 
   3.4733293452184553`*^9}, 3.473330203598768*^9, 3.473330319613023*^9, 
   3.473341603123541*^9, {3.4733421222946653`*^9, 3.473342125936781*^9}, 
   3.47334523162138*^9, 3.473352113259364*^9, {3.473352276882365*^9, 
   3.4733522842766953`*^9}, 3.4733557839685097`*^9, 3.473355830595406*^9, 
   3.4733597938039618`*^9, 3.4734139734061937`*^9, 3.473416404168038*^9, 
   3.473421236782251*^9, 3.473421426724593*^9, 3.473431510453702*^9, 
   3.473596575675921*^9, 3.4741740206906548`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EstimatedLags", ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"EstimatedDelays", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
       RowBox[{"EstimatedDelays", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"EstimatedDelays", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"EstimatedDelays", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"EstimatedDelays", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"EstimatedDelays", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"EstimatedLags", " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"baseline", "*", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "/", "SoS"}]}], ")"}]}], "//", 
   "MatrixForm", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"note", " ", "manual", " ", "factorization"}], " ", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.473178632921953*^9, 3.473178679172299*^9}, {
   3.473178809268581*^9, 3.4731788171382637`*^9}, {3.473179913210979*^9, 
   3.4731799279126797`*^9}, 3.4731801982724667`*^9, {3.4731879542366734`*^9, 
   3.473187969412323*^9}, {3.4731898785946836`*^9, 3.473189909828987*^9}, {
   3.4733302217904463`*^9, 3.473330229378813*^9}, {3.473341607460478*^9, 
   3.473341607682205*^9}, {3.473342202963037*^9, 3.4733422041049767`*^9}, {
   3.473355834025692*^9, 3.4733558682627497`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SqrtBox["3"]}], " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox["3"], " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]},
      {
       RowBox[{
        SqrtBox["3"], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.4731786794754457`*^9, {3.47317878777967*^9, 3.473178817775861*^9}, 
   3.473178918122753*^9, 3.4731789824330463`*^9, 3.473179205430702*^9, 
   3.4731794492699947`*^9, 3.4731794920980988`*^9, 3.473179843993392*^9, 
   3.473179894266982*^9, {3.473179928235853*^9, 3.473179932781492*^9}, 
   3.473180060081546*^9, 3.473180109387582*^9, 3.473180199155258*^9, 
   3.4731802939654417`*^9, 3.473180540379731*^9, 3.473180807556299*^9, 
   3.473182855750627*^9, 3.473184160965938*^9, 3.473185736886347*^9, 
   3.473186380172229*^9, 3.473187595674155*^9, 3.473187796156372*^9, 
   3.4731878652637978`*^9, {3.473187960302019*^9, 3.473187969878304*^9}, 
   3.4731881386444073`*^9, {3.473188340134899*^9, 3.4731883639081297`*^9}, {
   3.47318848624115*^9, 3.473188508253955*^9}, {3.473188556571981*^9, 
   3.473188576309116*^9}, {3.473189879261014*^9, 3.4731899106892557`*^9}, 
   3.473190561759738*^9, 3.473236958341517*^9, 3.473237813541397*^9, 
   3.473238754754655*^9, 3.473239015491675*^9, 3.4733272929127283`*^9, {
   3.473329332614472*^9, 3.4733293461074123`*^9}, {3.473330206721786*^9, 
   3.473330229923636*^9}, 3.473330321857032*^9, {3.473341605933915*^9, 
   3.4733416080365133`*^9}, 3.473342126634438*^9, 3.473342204352619*^9, 
   3.473352113773184*^9, 3.473352786411495*^9, {3.473355843373671*^9, 
   3.47335587885152*^9}, 3.473359794366201*^9, 3.473413974635992*^9, 
   3.473416405755698*^9, 3.473421237249526*^9, 3.473421428177683*^9, 
   3.4734315105242233`*^9, 3.473596576943286*^9, 3.474174021125333*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"soln", ":=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"EstimatedLags", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "m1"}], ",", 
       RowBox[{
        RowBox[{"EstimatedLags", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "\[Equal]", " ", "m2"}], ",", 
       " ", 
       RowBox[{
        RowBox[{"EstimatedLags", "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "\[Equal]", " ", "m3"}]}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}]}], ";", 
  "soln"}]], "Input",
 CellChangeTimes->{{3.473193595938385*^9, 3.473193652656228*^9}, {
   3.4731947605308733`*^9, 3.473194816058749*^9}, {3.473194890046474*^9, 
   3.4731949048692827`*^9}, {3.473195639855403*^9, 3.473195714364264*^9}, {
   3.473233124028666*^9, 3.473233126100255*^9}, {3.473236970779181*^9, 
   3.473236972145123*^9}, {3.4732380551343117`*^9, 3.4732381811984367`*^9}, {
   3.473238216583962*^9, 3.473238287863721*^9}, {3.4732390177646914`*^9, 
   3.473239173388345*^9}, {3.4732392049996643`*^9, 3.473239284881557*^9}, 
   3.473239351021946*^9, {3.473244878103489*^9, 3.473244931915831*^9}, {
   3.47324497178503*^9, 3.4732449994362698`*^9}, {3.473245113175105*^9, 
   3.473245113283243*^9}, {3.473352212494873*^9, 3.473352220415696*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.473244921904518*^9, 3.473244932637918*^9}, {
   3.4732449762514763`*^9, 3.473245001214821*^9}, 3.4732451140220013`*^9, 
   3.4733272966448097`*^9, 3.473341610250945*^9, 3.47334212985354*^9, 
   3.473352114229973*^9, {3.4733522171225557`*^9, 3.473352220729117*^9}, 
   3.4733527888915043`*^9, 3.473355879755183*^9, 3.4733597944688883`*^9, 
   3.47341397521708*^9, 3.4734164061787233`*^9, 3.4734212374736233`*^9, 
   3.473421429048004*^9, 3.4734315106564913`*^9, 3.473596577453567*^9, 
   3.474174021179599*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", "FAIL", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.473352223981691*^9, 3.473352226357915*^9}}],

Cell["", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Aaannnnddd", "..."}], " ", "try", " ", "another", " ", 
    RowBox[{"approach", ":", " ", 
     RowBox[{
      RowBox[{"conjugate", " ", "gradient", " ", "on", " ", "sum"}], "-", 
      "of", "-", 
      RowBox[{"squared", " ", "error"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MSE", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m1", "-", 
         RowBox[{
          RowBox[{"EstimatedLags", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "*", " ", 
          RowBox[{"10", "^", "6"}]}]}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m2", "-", 
         RowBox[{
          RowBox[{"EstimatedLags", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "*", " ", 
          RowBox[{"10", "^", "6"}]}]}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m3", "-", 
         RowBox[{
          RowBox[{"EstimatedLags", "[", 
           RowBox[{"[", "3", "]"}], "]"}], " ", "*", " ", 
          RowBox[{"10", "^", "6"}]}]}], ")"}], "^", "2"}]}]}], ";", " ", 
    "MSE"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.473232673360531*^9, 3.473232798368072*^9}, {
   3.4732375442104683`*^9, 3.4732375537343063`*^9}, {3.473238615924622*^9, 
   3.473238619152915*^9}, {3.4732386879188766`*^9, 3.473238688302824*^9}, 
   3.473328030684579*^9, 3.473329352570682*^9, {3.473342157302363*^9, 
   3.4733421880830803`*^9}, 3.473343073204152*^9, {3.473345433334228*^9, 
   3.4733454464009867`*^9}, 3.473345589562883*^9, {3.473352167478755*^9, 
   3.4733521717000713`*^9}, {3.473352381356529*^9, 3.473352383904531*^9}, {
   3.473402950710122*^9, 3.473402953860561*^9}, {3.473403064374267*^9, 
   3.4734030647803783`*^9}, {3.4734030990998363`*^9, 3.473403109729631*^9}, {
   3.473416379944201*^9, 3.473416414275593*^9}, {3.473416831953218*^9, 
   3.473416840941079*^9}, {3.47341707527715*^9, 3.473417080347145*^9}, {
   3.473417487909198*^9, 3.473417494713377*^9}, {3.473417586841063*^9, 
   3.47341761741966*^9}, {3.4734231097476597`*^9, 3.473423110375474*^9}, 
   3.4734236015856743`*^9, {3.473427887661524*^9, 3.473427889900119*^9}, 
   3.4734280666384983`*^9, {3.473428527100666*^9, 3.4734285289380198`*^9}, {
   3.473428570962186*^9, 3.4734286752327557`*^9}, {3.473428811909389*^9, 
   3.473428817635347*^9}, {3.4735965697701674`*^9, 3.473596627325574*^9}, {
   3.473596782897081*^9, 3.4735968076500607`*^9}, {3.4735968607985573`*^9, 
   3.4735968620901546`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"m3", "-", 
     FractionBox[
      RowBox[{"1000000", " ", 
       SqrtBox["3"], " ", "baseline", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "SoS"]}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"m2", "-", 
     FractionBox[
      RowBox[{"500000", " ", "baseline", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox["3"], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{"3", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "SoS"]}], ")"}],
    "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"m1", "+", 
     FractionBox[
      RowBox[{"500000", " ", "baseline", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox["3"], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "SoS"]}], ")"}],
    "2"]}]], "Output",
 CellChangeTimes->{{3.473596570920388*^9, 3.473596627752276*^9}, {
   3.473596784005455*^9, 3.473596807984972*^9}, 3.473596862835022*^9, 
   3.4741740212609663`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"subst", " ", ":=", " ", 
   RowBox[{"{", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SqrtBox["3"], " ", 
       RowBox[{"(", 
        RowBox[{"m1", "-", "m2", "-", 
         RowBox[{"2", " ", "m3"}]}], ")"}], " ", "SoS"}], "\[Rule]", "y"}], 
     ",", 
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{"m1", " ", "+", "m2"}], ")"}], "SoS"}], "\[Rule]", "z"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4734238753839493`*^9, 3.473423878662846*^9}, 
   3.473424026698271*^9, {3.473427914896545*^9, 3.473427915327394*^9}, {
   3.473428023858912*^9, 3.473428060990934*^9}, {3.473428091048676*^9, 
   3.473428091204418*^9}, {3.473428164391398*^9, 3.473428167317363*^9}, 
   3.473428684723454*^9, {3.4734288835667*^9, 3.473428913721723*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dEd\[Theta]\[Phi]", ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"MSE", ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "}"}]}], "]"}], "]"}]}], 
  ";", 
  RowBox[{"tmp", " ", ":=", " ", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"dEd\[Theta]\[Phi]", "/", 
      RowBox[{"(", 
       RowBox[{"baseline", "*", 
        RowBox[{"10", "^", "6"}]}], ")"}]}], "]"}], "//.", " ", "subst"}]}], 
  ";", " ", "tmp"}]], "Input",
 CellChangeTimes->{{3.473234531689169*^9, 3.473234557963296*^9}, {
   3.4732346040691957`*^9, 3.473234606080102*^9}, {3.473234686298388*^9, 
   3.473234748131733*^9}, {3.473238592023364*^9, 3.473238592370409*^9}, 
   3.473328033680668*^9, {3.4733303557863703`*^9, 3.473330375231647*^9}, {
   3.47334161502113*^9, 3.473341615730266*^9}, {3.4733421475011587`*^9, 
   3.473342151996467*^9}, {3.4733430652627172`*^9, 3.473343080540844*^9}, {
   3.473345092401517*^9, 3.47334511057094*^9}, {3.473345150671474*^9, 
   3.473345173453126*^9}, {3.473345262442387*^9, 3.473345316884099*^9}, {
   3.4733457294311333`*^9, 3.473345731517152*^9}, {3.473350593676795*^9, 
   3.47335059879768*^9}, {3.473352662397954*^9, 3.473352663989499*^9}, {
   3.4733527131011467`*^9, 3.4733527162360783`*^9}, {3.473352754806171*^9, 
   3.473352756202076*^9}, {3.47335591207128*^9, 3.473355923829247*^9}, {
   3.473356186129345*^9, 3.473356201881123*^9}, {3.473356831777049*^9, 
   3.473356847934869*^9}, {3.47340298332162*^9, 3.473403011892396*^9}, {
   3.473413959677775*^9, 3.4734140445844*^9}, {3.473414103087195*^9, 
   3.473414158602476*^9}, {3.473414265960166*^9, 3.4734143049812098`*^9}, {
   3.473417118532866*^9, 3.473417121020461*^9}, {3.4734176276980543`*^9, 
   3.4734176798013973`*^9}, {3.473417728884293*^9, 3.4734179843392267`*^9}, {
   3.473418159482416*^9, 3.4734182469648314`*^9}, {3.473421049814164*^9, 
   3.473421138047015*^9}, {3.473421210118239*^9, 3.473421213806039*^9}, {
   3.473421528057679*^9, 3.473421542230961*^9}, {3.473421685733509*^9, 
   3.473421764468511*^9}, {3.473422082701459*^9, 3.4734220873437157`*^9}, {
   3.4734231196993523`*^9, 3.4734231227970753`*^9}, {3.473423660923834*^9, 
   3.473423661220091*^9}, {3.473423708028008*^9, 3.473423718995886*^9}, {
   3.47342376551094*^9, 3.473423777545658*^9}, {3.4734238736478043`*^9, 
   3.4734238831503677`*^9}, {3.4734265343954906`*^9, 
   3.4734265597622747`*^9}, {3.473428869451392*^9, 3.473428873209613*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "+", "m2"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        SqrtBox["3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "m1"}], "+", "m2", "+", 
          RowBox[{"2", " ", "m3"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "SoS"], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
        RowBox[{"9000000", " ", "baseline", " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
        RowBox[{"z", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
     SuperscriptBox["SoS", "2"]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.473426560093787*^9, {3.4734279047703323`*^9, 3.473427917748715*^9}, {
   3.473428025112885*^9, 3.473428092352416*^9}, 3.473428168998043*^9, 
   3.473428531153738*^9, {3.473428575300408*^9, 3.4734286182651787`*^9}, {
   3.473428677097814*^9, 3.473428685901738*^9}, 3.4734288227980633`*^9, {
   3.4734288742503366`*^9, 3.473428914967821*^9}, 3.473431511773717*^9, 
   3.474174023215117*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    RowBox[{"tmp", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "SoS"}], " ", "*", "  ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", "*", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"z", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], " ", "-", 
         RowBox[{"y", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], ")"}], "//.", 
     " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"y", "->", 
        RowBox[{
         SqrtBox["3"], " ", 
         RowBox[{"(", 
          RowBox[{"m1", "-", "m2", "-", 
           RowBox[{"2", " ", "m3"}]}], ")"}], " ", "SoS"}]}], ",", 
       RowBox[{"z", "\[Rule]", " ", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"m1", " ", "+", "m2"}], ")"}], " ", "SoS"}]}]}], "}"}]}], 
    ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.473421781795713*^9, 3.473421804127617*^9}, {
   3.473421849341385*^9, 3.473421868194006*^9}, {3.4734219323091173`*^9, 
   3.473421936863505*^9}, {3.47342197432092*^9, 3.473422025031007*^9}, {
   3.4734220947044773`*^9, 3.4734221899847107`*^9}, {3.473422277513048*^9, 
   3.473422410983129*^9}, {3.473423889521018*^9, 3.4734238913173113`*^9}, {
   3.473423965659264*^9, 3.4734239661308203`*^9}, {3.473423997852357*^9, 
   3.473423999850356*^9}, {3.473424046250307*^9, 3.473424051136191*^9}, {
   3.4734265117737093`*^9, 3.473426513753677*^9}, {3.4734267135703487`*^9, 
   3.4734267151529922`*^9}, {3.47342677912714*^9, 3.4734268119423656`*^9}, {
   3.473428556736081*^9, 3.47342856123595*^9}, 3.473428923653781*^9, {
   3.473428975119089*^9, 3.4734289766679688`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.473422296944796*^9, {3.473422391812441*^9, 3.473422411529327*^9}, 
   3.473423135759788*^9, 3.473423893589755*^9, {3.4734239768459673`*^9, 
   3.473424000253615*^9}, {3.473424031361889*^9, 3.4734240517975187`*^9}, 
   3.473424152806632*^9, {3.473426514444038*^9, 3.47342654398216*^9}, 
   3.473426717385291*^9, 3.473426812909924*^9, 3.4734281961022587`*^9, {
   3.4734285468847837`*^9, 3.473428562167527*^9}, 3.473428939734157*^9, 
   3.473428977160651*^9, 3.4734315120894413`*^9, 3.474174023431175*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Measured", " ", "Lags", " ", 
     RowBox[{"{", 
      RowBox[{"m1", ",", " ", "m2", ",", " ", "m3"}], "}"}], " ", 
     "correspond", " ", "to", " ", "\[Theta]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"6", "\[Degree]", " ", "and", " ", "\[Phi]"}], "\[Rule]", 
     RowBox[{"26", "\[Degree]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"MSE", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m1", "\[Rule]", 
          RowBox[{"-", "114.58"}]}], ",", 
         RowBox[{"m2", "\[Rule]", "84.63"}], ",", 
         RowBox[{"m3", "\[Rule]", "199.22"}], ",", " ", 
         RowBox[{"baseline", "\[Rule]", "0.202"}], ",", 
         RowBox[{"SoS", "\[Rule]", "1550"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{"0", "\[Degree]"}], ",", 
       RowBox[{"12", "\[Degree]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"20", "\[Degree]"}], ",", 
       RowBox[{"32", "\[Degree]"}]}], "}"}]}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.473359294412305*^9, 3.4733593085289173`*^9}, {
   3.4733597281373796`*^9, 3.473359823340189*^9}, {3.473359883188326*^9, 
   3.473359983554109*^9}, {3.47336005316011*^9, 3.473360155514284*^9}, {
   3.473360223423574*^9, 3.473360224955329*^9}, {3.473361043035681*^9, 
   3.4733611103282824`*^9}, {3.4734044463884993`*^9, 
   3.4734044469317217`*^9}, {3.473414209151072*^9, 3.473414211148085*^9}, {
   3.47342716175109*^9, 3.4734271693789253`*^9}, {3.473427870224859*^9, 
   3.4734278773102503`*^9}, {3.473430016793054*^9, 3.473430019562479*^9}, 
   3.474174009241229*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Plot", " ", "derivatives"}], " ", "*)"}], 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"dEd\[Theta]\[Phi]", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m1", "\[Rule]", 
          RowBox[{"-", "114.58"}]}], ",", 
         RowBox[{"m2", "\[Rule]", "84.63"}], ",", 
         RowBox[{"m3", "\[Rule]", "199.22"}], ",", " ", 
         RowBox[{"baseline", "\[Rule]", "0.202"}], ",", 
         RowBox[{"SoS", "\[Rule]", "1550"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{"0", "\[Degree]"}], ",", 
       RowBox[{"360", "\[Degree]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"0", "\[Degree]"}], ",", 
       RowBox[{"89", "\[Degree]"}]}], "}"}]}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.4733598504009933`*^9, {3.473429674633894*^9, 3.4734296982775793`*^9}, {
   3.4734300034005613`*^9, 3.473430008944419*^9}, 3.473430516875228*^9, 
   3.474174012686434*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot3D", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"dEd\[Theta]\[Phi]", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m1", "\[Rule]", 
         RowBox[{"-", "114.58"}]}], ",", 
        RowBox[{"m2", "\[Rule]", "84.63"}], ",", 
        RowBox[{"m3", "\[Rule]", "199.22"}], ",", " ", 
        RowBox[{"baseline", "\[Rule]", "0.202"}], ",", 
        RowBox[{"SoS", "\[Rule]", "1550"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", 
      RowBox[{"0", "\[Degree]"}], ",", 
      RowBox[{"360", "\[Degree]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"0", "\[Degree]"}], ",", 
      RowBox[{"89", "\[Degree]"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4734297135240507`*^9, 3.4734297140930147`*^9}, {
   3.473430035298214*^9, 3.473430039167362*^9}, {3.4734304732985897`*^9, 
   3.473430480368085*^9}, 3.4741740164305973`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dEd\[Theta]\[Phi]", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", "\[Theta]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.473430246382194*^9, 3.473430271003196*^9}, {
   3.473430318457494*^9, 3.473430319596958*^9}, {3.473430595241124*^9, 
   3.473430640436686*^9}, 3.473430766189282*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"m2", "\[Equal]", 
     RowBox[{"-", "m1"}]}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"-", "\[Pi]"}], "+", "\[Theta]"}], 
          RowBox[{"2", " ", "\[Pi]"}]], "\[NotElement]", "Integers"}], "&&", 
        RowBox[{"SoS", "\[NotEqual]", "0"}], "&&", 
        RowBox[{"m3", "\[Equal]", "m1"}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}], "&&", 
        RowBox[{
         RowBox[{"m1", "-", "m3"}], "\[NotEqual]", "0"}], "&&", 
        RowBox[{"SoS", "\[NotEqual]", "0"}], "&&", 
        RowBox[{"\[Theta]", "\[Equal]", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"C", "[", "1", "]"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"SoS", "\[NotEqual]", "0"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"baseline", "\[Equal]", "0"}], "||", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "\[Equal]", "0"}]}], ")"}]}], 
   ")"}], "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"m1", "+", "m2"}], "\[NotEqual]", "0"}], "&&", 
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["m1", "2"]}], "+", 
            RowBox[{"2", " ", "m1", " ", "m2"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["m2", "2"]}], "-", 
            RowBox[{"2", " ", "m1", " ", "m3"}], "+", 
            RowBox[{"2", " ", "m2", " ", "m3"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["m3", "2"]}], "+", 
            RowBox[{"m1", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["m1", "2"], "+", 
               RowBox[{"m1", " ", "m2"}], "+", 
               SuperscriptBox["m2", "2"], "-", 
               RowBox[{"m1", " ", "m3"}], "+", 
               RowBox[{"m2", " ", "m3"}], "+", 
               SuperscriptBox["m3", "2"]}]]}], "-", 
            RowBox[{"m2", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["m1", "2"], "+", 
               RowBox[{"m1", " ", "m2"}], "+", 
               SuperscriptBox["m2", "2"], "-", 
               RowBox[{"m1", " ", "m3"}], "+", 
               RowBox[{"m2", " ", "m3"}], "+", 
               SuperscriptBox["m3", "2"]}]]}], "-", 
            RowBox[{"2", " ", "m3", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["m1", "2"], "+", 
               RowBox[{"m1", " ", "m2"}], "+", 
               SuperscriptBox["m2", "2"], "-", 
               RowBox[{"m1", " ", "m3"}], "+", 
               RowBox[{"m2", " ", "m3"}], "+", 
               SuperscriptBox["m3", "2"]}]]}]}], ")"}], " ", "SoS"}], 
         "\[NotEqual]", "0"}], "&&", 
        RowBox[{"\[Theta]", "\[Equal]", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"ArcTan", "[", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SqrtBox["3"]}], " ", "m1"}], "+", 
              RowBox[{
               SqrtBox["3"], " ", "m2"}], "+", 
              RowBox[{"2", " ", 
               SqrtBox["3"], " ", "m3"}], "-", 
              RowBox[{"2", " ", 
               SqrtBox["3"], " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["m1", "2"], "+", 
                 RowBox[{"m1", " ", "m2"}], "+", 
                 SuperscriptBox["m2", "2"], "-", 
                 RowBox[{"m1", " ", "m3"}], "+", 
                 RowBox[{"m2", " ", "m3"}], "+", 
                 SuperscriptBox["m3", "2"]}]]}]}], 
             RowBox[{"3", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}]}]], "]"}]}], "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
           RowBox[{"C", "[", "1", "]"}]}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["m1", "2"]}], "-", 
            RowBox[{"2", " ", "m1", " ", "m2"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["m2", "2"]}], "+", 
            RowBox[{"2", " ", "m1", " ", "m3"}], "-", 
            RowBox[{"2", " ", "m2", " ", "m3"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["m3", "2"]}], "+", 
            RowBox[{"m1", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["m1", "2"], "+", 
               RowBox[{"m1", " ", "m2"}], "+", 
               SuperscriptBox["m2", "2"], "-", 
               RowBox[{"m1", " ", "m3"}], "+", 
               RowBox[{"m2", " ", "m3"}], "+", 
               SuperscriptBox["m3", "2"]}]]}], "-", 
            RowBox[{"m2", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["m1", "2"], "+", 
               RowBox[{"m1", " ", "m2"}], "+", 
               SuperscriptBox["m2", "2"], "-", 
               RowBox[{"m1", " ", "m3"}], "+", 
               RowBox[{"m2", " ", "m3"}], "+", 
               SuperscriptBox["m3", "2"]}]]}], "-", 
            RowBox[{"2", " ", "m3", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["m1", "2"], "+", 
               RowBox[{"m1", " ", "m2"}], "+", 
               SuperscriptBox["m2", "2"], "-", 
               RowBox[{"m1", " ", "m3"}], "+", 
               RowBox[{"m2", " ", "m3"}], "+", 
               SuperscriptBox["m3", "2"]}]]}]}], ")"}], " ", "SoS"}], 
         "\[NotEqual]", "0"}], "&&", 
        RowBox[{"\[Theta]", "\[Equal]", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"ArcTan", "[", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SqrtBox["3"]}], " ", "m1"}], "+", 
              RowBox[{
               SqrtBox["3"], " ", "m2"}], "+", 
              RowBox[{"2", " ", 
               SqrtBox["3"], " ", "m3"}], "+", 
              RowBox[{"2", " ", 
               SqrtBox["3"], " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["m1", "2"], "+", 
                 RowBox[{"m1", " ", "m2"}], "+", 
                 SuperscriptBox["m2", "2"], "-", 
                 RowBox[{"m1", " ", "m3"}], "+", 
                 RowBox[{"m2", " ", "m3"}], "+", 
                 SuperscriptBox["m3", "2"]}]]}]}], 
             RowBox[{"3", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}]}]], "]"}]}], "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
           RowBox[{"C", "[", "1", "]"}]}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}], "&&", 
    RowBox[{"SoS", "\[NotEqual]", "0"}], "&&", 
    RowBox[{"m2", "\[Equal]", 
     RowBox[{"-", "m1"}]}], "&&", 
    RowBox[{"\[Theta]", "\[Equal]", 
     RowBox[{"\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", 
         RowBox[{"C", "[", "1", "]"}]}]}], ")"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.473430273656321*^9, 3.473430320388867*^9, {3.473430616073105*^9, 
   3.473430619829503*^9}, {3.4734307634596663`*^9, 3.473430766774375*^9}, 
   3.473431522859251*^9, 3.474174028970048*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"my\[Theta]", "=", 
  RowBox[{"2", " ", 
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SqrtBox["3"]}], " ", "m1"}], "+", 
      RowBox[{
       SqrtBox["3"], " ", "m2"}], "+", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox["3"], " ", "m3"}], "\[PlusMinus]", 
       RowBox[{"2", " ", 
        SqrtBox["3"], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m1", "2"], "+", 
          RowBox[{"m1", " ", "m2"}], "+", 
          SuperscriptBox["m2", "2"], "-", 
          RowBox[{"m1", " ", "m3"}], "+", 
          RowBox[{"m2", " ", "m3"}], "+", 
          SuperscriptBox["m3", "2"]}]]}]}]}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"m1", "+", "m2"}], ")"}]}]], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.4734308432613564`*^9, 3.473430863605727*^9}, {
  3.47343093077682*^9, 3.473430941476254*^9}, {3.473431107385106*^9, 
  3.473431131456547*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"ArcTan", "[", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SqrtBox["3"]}], " ", "m1"}], "+", 
     RowBox[{
      SqrtBox["3"], " ", "m2"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox["3"], " ", "m3"}], "\[PlusMinus]", 
       RowBox[{"2", " ", 
        SqrtBox["3"], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m1", "2"], "+", 
          RowBox[{"m1", " ", "m2"}], "+", 
          SuperscriptBox["m2", "2"], "-", 
          RowBox[{"m1", " ", "m3"}], "+", 
          RowBox[{"m2", " ", "m3"}], "+", 
          SuperscriptBox["m3", "2"]}]]}]}], ")"}]}], 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{"m1", "+", "m2"}], ")"}]}]], "]"}]}]], "Output",
 CellChangeTimes->{
  3.473430961669512*^9, {3.473431125178836*^9, 3.473431131763323*^9}, 
   3.473431522905507*^9, 3.474174029221603*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dEd\[Theta]\[Phi]", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "\[Phi]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.473430284755557*^9, 3.47343028779499*^9}, {
  3.473430331364403*^9, 3.473430332158906*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "\[Element]", "Integers"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"baseline", "\[NotEqual]", "0"}], "&&", 
        RowBox[{"SoS", "\[NotEqual]", "0"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Phi]", "\[Equal]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"ArcCos", "[", 
              RowBox[{
               FractionBox["1", 
                RowBox[{"9000000", " ", "baseline"}]], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   SqrtBox["3"]}], " ", "m1", " ", "SoS", " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
                 RowBox[{
                  SqrtBox["3"], " ", "m2", " ", "SoS", " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
                 RowBox[{"2", " ", 
                  SqrtBox["3"], " ", "m3", " ", "SoS", " ", 
                  RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
                 RowBox[{"3", " ", "m1", " ", "SoS", " ", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
                 RowBox[{"3", " ", "m2", " ", "SoS", " ", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}],
             "+", 
            RowBox[{"2", " ", "\[Pi]", " ", 
             RowBox[{"C", "[", "1", "]"}]}]}]}], "||", 
          RowBox[{"\[Phi]", "\[Equal]", 
           RowBox[{
            RowBox[{"ArcCos", "[", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"9000000", " ", "baseline"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  SqrtBox["3"]}], " ", "m1", " ", "SoS", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
                RowBox[{
                 SqrtBox["3"], " ", "m2", " ", "SoS", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
                RowBox[{"2", " ", 
                 SqrtBox["3"], " ", "m3", " ", "SoS", " ", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
                RowBox[{"3", " ", "m1", " ", "SoS", " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
                RowBox[{"3", " ", "m2", " ", "SoS", " ", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}], 
            "+", 
            RowBox[{"2", " ", "\[Pi]", " ", 
             RowBox[{"C", "[", "1", "]"}]}]}]}]}], ")"}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"SoS", "\[NotEqual]", "0"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Phi]", "\[Equal]", 
           RowBox[{"2", " ", "\[Pi]", " ", 
            RowBox[{"C", "[", "1", "]"}]}]}], "||", 
          RowBox[{"\[Phi]", "\[Equal]", 
           RowBox[{"\[Pi]", "+", 
            RowBox[{"2", " ", "\[Pi]", " ", 
             RowBox[{"C", "[", "1", "]"}]}]}]}]}], ")"}]}], ")"}]}], ")"}]}], 
   ")"}], "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"baseline", "\[Equal]", "0"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m2", "\[Equal]", 
         RowBox[{"-", "m1"}]}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"SoS", "\[NotEqual]", "0"}], "&&", 
            RowBox[{"m3", "\[Equal]", "m1"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"m1", "-", "m3"}], "\[NotEqual]", "0"}], "&&", 
            RowBox[{"SoS", "\[NotEqual]", "0"}], "&&", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "\[Equal]", "0"}]}], 
           ")"}]}], ")"}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"m1", "+", "m2"}], "\[NotEqual]", "0"}], "&&", 
        RowBox[{"SoS", "\[NotEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "\[Equal]", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SqrtBox["3"]}], " ", "m1", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{
            SqrtBox["3"], " ", "m2", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"2", " ", 
            SqrtBox["3"], " ", "m3", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}]}]]}]}], ")"}]}], ")"}]}], ")"}], 
  "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"SoS", "\[NotEqual]", "0"}], "&&", 
    RowBox[{"baseline", "\[Equal]", "0"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.4734302888805532`*^9, 3.473430332584024*^9, 
  3.473431138595764*^9, 3.473431523183528*^9, 3.474174029417753*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"my\[Phi]", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"ArcCos", "[", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"9000000", " ", "baseline"}], ")"}]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SqrtBox["3"]}], " ", "m1", " ", "SoS", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
        SqrtBox["3"], " ", "m2", " ", "SoS", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox["3"], " ", "m3", " ", "SoS", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
       RowBox[{"3", " ", "m1", " ", "SoS", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
       RowBox[{"3", " ", "m2", " ", "SoS", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.473431188989501*^9, 3.4734312300288477`*^9}}],

Cell[BoxData[
 RowBox[{"ArcCos", "[", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"SoS", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SqrtBox["3"], " ", 
        RowBox[{"(", 
         RowBox[{"m1", "-", "m2", "-", 
          RowBox[{"2", " ", "m3"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "+", "m2"}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], 
    RowBox[{"9000000", " ", "baseline"}]]}], "]"}]], "Output",
 CellChangeTimes->{3.473431231899837*^9, 3.473431525734618*^9, 
  3.474174030885068*^9}]
}, Open  ]]
},
WindowToolbars->{},
WindowSize->{725, 752},
WindowMargins->{{-4, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 1206, 21, 43, "Input"],
Cell[CellGroupData[{
Cell[1776, 45, 1572, 33, 58, "Input"],
Cell[3351, 80, 1963, 45, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5351, 130, 406, 8, 43, "Input"],
Cell[5760, 140, 2426, 67, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8223, 212, 1462, 26, 43, "Input"],
Cell[9688, 240, 2213, 56, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11938, 301, 1550, 37, 88, "Input"],
Cell[13491, 340, 2869, 64, 97, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16397, 409, 1394, 30, 58, "Input"],
Cell[17794, 441, 577, 9, 27, "Output"]
}, Open  ]],
Cell[18386, 453, 130, 2, 27, "Input"],
Cell[18519, 457, 270, 9, 10, "Text"],
Cell[CellGroupData[{
Cell[18814, 470, 2606, 55, 103, "Input"],
Cell[21423, 527, 1355, 40, 157, "Output"]
}, Open  ]],
Cell[22793, 570, 822, 21, 39, "Input"],
Cell[CellGroupData[{
Cell[23640, 595, 2522, 44, 58, "Input"],
Cell[26165, 641, 1437, 38, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27639, 684, 1813, 42, 105, "Input"],
Cell[29455, 728, 559, 8, 27, "Output"]
}, Open  ]],
Cell[30029, 739, 1766, 40, 73, "Input"],
Cell[31798, 781, 1138, 30, 73, "Input"],
Cell[32939, 813, 1027, 26, 58, "Input"],
Cell[CellGroupData[{
Cell[33991, 843, 383, 9, 27, "Input"],
Cell[34377, 854, 7631, 203, 497, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42045, 1062, 973, 29, 59, "Input"],
Cell[43021, 1093, 931, 29, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43989, 1127, 307, 8, 27, "Input"],
Cell[44299, 1137, 5008, 129, 324, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49344, 1271, 962, 25, 131, "Input"],
Cell[50309, 1298, 651, 19, 53, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
